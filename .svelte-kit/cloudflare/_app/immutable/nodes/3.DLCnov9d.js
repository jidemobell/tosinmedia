import{t as m,a as l}from"../chunks/Df_PLGO5.js";import"../chunks/BWJaVeZx.js";import{p as W,l as q,a as z,t as d,b as A,s as i,c as s,d as c,m as p,r,g as a}from"../chunks/Dn-Cg2qP.js";import{s as g,e as D}from"../chunks/BvUzH-nj.js";import{i as G}from"../chunks/BvRSQFq4.js";import{e as E,i as N}from"../chunks/C3NhGQ0R.js";import{i as H}from"../chunks/CsMcRiQP.js";import{s as I,a as K}from"../chunks/CworngRU.js";import{o as L}from"../chunks/DVUgDGkq.js";import{p as Q}from"../chunks/D1kYtXJX.js";var R=m("<button>Pay Now</button>"),U=m("<li> <!></li>"),V=m("<li> </li>"),X=m("<div><h1> </h1> <section><h2>Your Bookings</h2> <ul></ul></section> <section><h2>Your Testimonials</h2> <ul></ul></section></div>");function ce(O,S){W(S,!1);const[Y,B]=I(),y=()=>K(Q,"$page",Y),f=p();let $=p({}),b=p([]),k=p([]);async function x(){try{const t=await fetch(`/api/user/profile?username=${a(f)}`);if(t.ok){const e=await t.json();c($,e.profile),c(b,e.bookings),c(k,e.testimonials)}else console.error("Failed to fetch profile")}catch(t){console.error("Error fetching profile:",t)}}L(x);async function C(t){try{(await fetch("/api/user/make-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingId:t,username:a(f)})})).ok?(alert("Payment successful!"),x()):alert("Payment failed.")}catch(e){console.error("Error making payment:",e)}}q(()=>y(),()=>{c(f,y().params.username)}),z(),H();var u=X(),v=s(u),F=s(v);r(v);var _=i(v,2),P=i(s(_),2);E(P,5,()=>a(b),N,(t,e)=>{var o=U(),n=s(o),J=i(n);{var M=h=>{var j=R();D("click",j,()=>C(a(e).id)),l(h,j)};G(J,h=>{a(e).status==="pending"&&h(M)})}r(o),d(()=>g(n,`${a(e).event_name??""} - ${a(e).status??""} `)),l(t,o)}),r(P),r(_);var w=i(_,2),T=i(s(w),2);E(T,5,()=>a(k),N,(t,e)=>{var o=V(),n=s(o,!0);r(o),d(()=>g(n,a(e).message)),l(t,o)}),r(T),r(w),r(u),d(()=>g(F,`Welcome, ${a($).username??""}`)),l(O,u),A(),B()}export{ce as component};
