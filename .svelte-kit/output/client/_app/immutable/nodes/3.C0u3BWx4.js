import{t as m,a as l}from"../chunks/FqEdNSdB.js";import"../chunks/BQjKAKWr.js";import{p as W,l as q,a as z,t as d,b as A,s as i,c as o,d as c,m as p,r,g as a}from"../chunks/CuIcymPu.js";import{s as g,e as D}from"../chunks/CAHhALS2.js";import{s as G,a as H,i as I}from"../chunks/C2Y7dR0l.js";import{e as E,i as N}from"../chunks/DxNlWU_Q.js";import{i as K}from"../chunks/TF1EcFJg.js";import{o as L}from"../chunks/UhPjgVww.js";import{p as Q}from"../chunks/D-aeuI9u.js";var R=m("<button>Pay Now</button>"),U=m("<li> <!></li>"),V=m("<li> </li>"),X=m("<div><h1> </h1> <section><h2>Your Bookings</h2> <ul></ul></section> <section><h2>Your Testimonials</h2> <ul></ul></section></div>");function le(O,S){W(S,!1);const[Y,B]=G(),y=()=>H(Q,"$page",Y),f=p();let $=p({}),b=p([]),k=p([]);async function x(){try{const t=await fetch(`/api/user/profile?username=${a(f)}`);if(t.ok){const e=await t.json();c($,e.profile),c(b,e.bookings),c(k,e.testimonials)}else console.error("Failed to fetch profile")}catch(t){console.error("Error fetching profile:",t)}}L(x);async function C(t){try{(await fetch("/api/user/make-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookingId:t,username:a(f)})})).ok?(alert("Payment successful!"),x()):alert("Payment failed.")}catch(e){console.error("Error making payment:",e)}}q(()=>y(),()=>{c(f,y().params.username)}),z(),K();var u=X(),v=o(u),F=o(v);r(v);var _=i(v,2),P=i(o(_),2);E(P,5,()=>a(b),N,(t,e)=>{var s=U(),n=o(s),J=i(n);{var M=h=>{var j=R();D("click",j,()=>C(a(e).id)),l(h,j)};I(J,h=>{a(e).status==="pending"&&h(M)})}r(s),d(()=>g(n,`${a(e).event_name??""} - ${a(e).status??""} `)),l(t,s)}),r(P),r(_);var w=i(_,2),T=i(o(w),2);E(T,5,()=>a(k),N,(t,e)=>{var s=V(),n=o(s,!0);r(s),d(()=>g(n,a(e).message)),l(t,s)}),r(T),r(w),r(u),d(()=>g(F,`Welcome, ${a($).username??""}`)),l(O,u),A(),B()}export{le as component};
